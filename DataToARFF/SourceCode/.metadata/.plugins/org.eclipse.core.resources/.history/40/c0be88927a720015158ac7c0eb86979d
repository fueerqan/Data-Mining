package com.portalbisnisbersama;

import java.awt.BorderLayout;
import java.awt.GridLayout;
import java.io.FileInputStream;
import java.io.IOException;

import javax.swing.JButton;
import javax.swing.JFileChooser;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTextArea;

public class Details {
	String path, file, judul;
	JTextArea teksFile = new JTextArea();
	JTextArea teksDesc = new JTextArea();
	JTextArea teksAttr = new JTextArea();
	JFrame frame;
	JButton btnNext;
	JLabel lblFile, lblAttr;
	JScrollPane sp = new JScrollPane(teksFile);
	JFileChooser pemilihFile;
	
	/**
	 * Constructor class Details
	 */
	public Details() {
		// TODO Auto-generated constructor stub
		buatFrame();
		
		isiDesc();
	}
	
	/**
	 * Fungsi untuk menginisialisasi frame dan hal lain yang berhubungan
	 */
	private void buatFrame()
	{
		frame = new JFrame("DataToARFF - Muhammad Furqan");
		frame.setSize(750, 550);
		frame.setLocationRelativeTo(null);
		
		komponen();
		
		frame.setVisible(true);
	}
	
	/**
	 * Fungsi untuk mengurus komponen dari frame
	 */
	private void komponen()
	{
		btnNext = new JButton("Lanjut >>");
		lblFile = new JLabel("Attribute dalam File name");
		lblAttr = new JLabel("Attribute Anda :");
		
		/*Panel untuk teksFIle*/
		JPanel panel2 = new JPanel();
		panel2.setLayout(new GridLayout(1,1));
		panel2.add(sp);
		
		/*Panel untuk file*/
		JPanel panel1 = new JPanel();
		panel1.setLayout(new BorderLayout());
		panel1.add(lblFile, BorderLayout.NORTH);
		panel1.add(panel2);
		
		/*Panel untuk teksAttr dan teksDesc*/
		JPanel panel3 = new JPanel();
		panel3.setLayout(new GridLayout(2, 1));
		panel3.add(teksAttr);
		panel3.add(teksDesc);
		
		/*Panel untuk teksBaru*/
		JPanel panel4 = new JPanel();
		panel4.setLayout(new BorderLayout());
		panel4.add(lblAttr, BorderLayout.NORTH);
		panel4.add(panel3, BorderLayout.CENTER);
		panel4.add(btnNext, BorderLayout.SOUTH);
		
		/*Panel Utama*/
		JPanel panel = (JPanel) frame.getContentPane();
		panel.setLayout(new GridLayout(1,2));
		panel.add(panel1);
		panel.add(panel4);
	}
	
	/**
	 * Fungsi yang mengatur teksDesc
	 */
	private void isiDesc()
	{
		String kata = "CARA PENULISAN : \n\n <nama-attribute> <type>\n <nama-attribute> <type>\nContoh : \n Id numeric\n\n<type> YANG TERSEDIA : \n1. numeric\n2. integer\n3. real\n4. {kategori1, kategori2, ...}\n5. date [<date-format>]";
		teksDesc.setText(kata);
		teksDesc.setLineWrap(true);
		teksDesc.setBackground(null);
		teksDesc.setFocusable(false);
	}
	
	/**
	 * Fungsi yang mengatur teksFile
	 */
	public void isiTeksFile()
	{
		olahFile();
		
		teksFile.setText(file);
		teksFile.setLineWrap(true);
		teksFile.setEditable(false);
		
	}
	
	/**
	 * Fungsi untuk menerima path yang di kirim dari class Main
	 * 
	 * @param path
	 */
	public void setPath(String path){
		this.path = path;
	}
	
	/**
	 * Fungsi untuk mengolah file yang telah di pilih oleh user
	 */
	private void olahFile()
	{
		FileInputStream f = null;
		try{
			f = new FileInputStream(path);
			String str = "";
			int b = 0;
			
			while( b != -1)
			{
				b = f.read();
				
				if((char) b != '\n')
				{
					str += (char) b;
				}
				else
				{
					str += (char) b;
					
					if(str.contains("Title"))
					{
						int last = str.lastIndexOf(":");
						
						judul = str.substring(last+1);
						judul = judul.trim();
						
						str = "";
						
					}
					else if(str.contains("Attribute"))
					{
						if(str.contains("8. Missing"))
						{
							int begin = str.lastIndexOf("7. Attribute");
							int last = str.lastIndexOf("8. Missing");
							
							file = str.substring(begin, last-1);
							str = "";
							
							break;
						}
					}
				}
			}
			
			f.close();
		}catch(IOException error)
		{
			JOptionPane.showMessageDialog(frame, "File gagal dibuka");
		}
	}
	
	/**
	 * Fungsi untuk memberikan aksi pada tombol
	 */
	public void Action()
	{
		
	}
}
